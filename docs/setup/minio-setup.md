# Настройка MinIO

> **⚠️ УСТАРЕЛО:** Начиная с feature-2.5 рекомендуется использовать **Yandex Object Storage** вместо MinIO для локальной разработки. Это обеспечивает публичный доступ к presigned URL без необходимости в ngrok для MinIO и приближает окружение к production.
>
> **Рекомендуется:** См. [feature-2.5-yandex-s3.md](../../features/feature-2.5-yandex-s3.md) и [yandex-s3-setup.md](yandex-s3-setup.md) для инструкций по настройке Yandex Object Storage.
>
> Данная документация оставлена для тех, кто все еще использует MinIO на ранних этапах разработки.

## Автоматическая инициализация

Бакет создается автоматически при первом запуске приложения через `s3_storage.get_s3_client()`.

> **Примечание:** Скрипты `init_minio.py` и `init_minio.sh` были удалены в feature-2.5. Бакет создается автоматически при первом запуске приложения.

## Ручная настройка через консоль MinIO

1. Запустить MinIO через docker-compose:
   ```bash
   docker-compose up minio
   ```

2. Открыть консоль MinIO: http://localhost:9001

3. Войти с учетными данными:
   - Username: `minioadmin`
   - Password: `minioadmin`

4. Создать бакет:
   - Нажать "Create Bucket"
   - Имя бакета: `ai-shtender-bucket` (или значение из `S3_BUCKET` в `.env`)
   - Нажать "Create Bucket"

## Структура папок

Бакет будет автоматически содержать следующие префиксы (папки):

- `images/input/` - исходные фото пользователей
- `images/output/` - результаты обработки (опционально)
- `tasks/` - JSON-файлы с состоянием задач

## Lifecycle Policy (опционально)

Для автоматической очистки старых файлов можно настроить Lifecycle Policy в консоли MinIO:

1. Открыть консоль MinIO
2. Выбрать бакет
3. Перейти в "Lifecycle"
4. Добавить правила:
   - `tasks/` - удалять через 2-3 дня
   - `images/input/` - удалять через 14 дней
   - `images/output/` - удалять через 14 дней
